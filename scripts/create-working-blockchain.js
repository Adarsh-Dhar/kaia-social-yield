const { createWalletClient, createPublicClient, http, parseEther } = require('viem');
const { privateKeyToAccount } = require('viem/accounts');
const { kairos } = require('viem/chains');

console.log('ðŸš€ Creating working blockchain solution...');

// Use the test private key
const OPERATOR_PRIVATE_KEY = "0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80";
const operatorAccount = privateKeyToAccount(OPERATOR_PRIVATE_KEY);

console.log('Operator address:', operatorAccount.address);

const walletClient = createWalletClient({
  account: operatorAccount,
  chain: kairos,
  transport: http('https://public-en-kairos.node.kaia.io')
});

const publicClient = createPublicClient({
  chain: kairos,
  transport: http('https://public-en-kairos.node.kaia.io')
});

// Simple contract bytecode for testing
const SIMPLE_CAMPAIGN_MANAGER_BYTECODE = "0x608060405234801561000f575f5ffd5b50336040518060400160405280600981526020017f4d6f636b205553445400000000000000000000000000000000000000000000008152506040518060400160405280600481526020017f5553445400000000000000000000000000000000000000000000000000000000815250816003908161008c9190610440565b50806004908161009c9190610440565b5050505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361010f575f6040517f1e4fbdf7000000000000000000000000000000000000000000000000000000008152600401610106919061054e565b60405180910390fd5b61011e8161014060201b60201c565b506006600560146101000a81548160ff021916908360ff160217905550610567565b5f60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160055f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061027e57607f821691505b6020821081036102915761029061023a565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026102f37fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826102b8565b6102fd86836102b8565b95508019841693508086168417925050509392505050565b5f819050919050565b5f819050919050565b5f61034161033c61033784610315565b61031e565b610315565b9050919050565b5f819050919050565b61035a83610327565b61036e61036682610348565b8484546102c4565b825550505050565b5f5f905090565b610385610376565b610390818484610351565b505050565b5b818110156103b3576103a85f8261037d565b600181019050610396565b5050565b601f8211156103f8576103c981610297565b6103d2846102a9565b810160208510156103e1578190505b6103f56103ed856102a9565b830182610395565b50505b505050565b5f82821c905092915050565b5f6104185f19846008026103fd565b1980831691505092915050565b5f6104308383610409565b9150826002028217905092915050565b61044982610203565b67ffffffffffffffff8111156104625761046161020d565b5b61046c8254610267565b6104778282856103b7565b5f60209050601f8311600181146104a8575f8415610496578287015190505b6104a08582610425565b865550610507565b601f1984166104b686610297565b5f5b828110156104dd578489015182556001820191506020850194506020810190506104b8565b868310156104fa57848901516104f6601f891682610409565b8355505b6001600288020188555050505b505050505050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6105388261050f565b9050919050565b6105488161052e565b82525050565b5f6020820190506105615f83018461053f565b92915050565b61112a806105745f395ff3fe608060405234801561000f575f5ffd5b50600436106100cd575f3560e01c806370a082311161008a57806395d89b411161006457806395d89b41146101ff578063a9059cbb1461021d578063dd62ed3e1461024d578063f2fde38b1461027d576100cd565b806370a08231146101a7578063715018a6146101d75780638da5cb5b146101e1576100cd565b806306fdde03146100d1578063095ea7b3146100ef57806318160ddd1461011f57806323b872dd1461013d578063313ce5671461016d57806340c10f191461018b575b5f5ffd5b6100d9610299565b6040516100e69190610da3565b60405180910390f35b61010960048036038101906101049190610e54565b610329565b6040516101169190610eac565b60405180910390f35b61012761034b565b6040516101349190610ed4565b60405180910390f35b61015760048036038101906101529190610eed565b610354565b6040516101649190610eac565b60405180910390f35b610175610382565b6040516101829190610f58565b60405180910390f35b6101a560048036038101906101a09190610e54565b610398565b005b6101c160048036038101906101bc9190610f71565b6103ae565b6040516101ce9190610ed4565b60405180910390f35b6101df6103f3565b005b6101e9610406565b6040516101f69190610fab565b60405180910390f35b61020761042e565b6040516102149190610da3565b60405180910390f35b61023760048036038101906102329190610e54565b6104be565b6040516102449190610eac565b60405180910390f35b61026760048036038101906102629190610fc4565b6104e0565b6040516102749190610ed4565b60405180910390f35b61029760048036038101906102929190610f71565b610562565b005b6060600380546102a89061102f565b80601f01602080910402602001604051908101604052809291908181526020018280546102d49061102f565b801561031f5780601f106102f65761010080835404028352916020019161031f565b820191905f5260205f20905b81548152906001019060200180831161030257829003601f168201915b5050505050905090565b5f5f6103336105e6565b90506103408185856105ed565b600191505092915050565b5f600254905090565b5f5f61035e6105e6565b905061036b8582856105ff565b610376858585610692565b60019150509392505050565b5f600560149054906101000a900460ff16905090565b6103a0610782565b6103aa8282610809565b5050565b5f5f5f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20549050919050565b6103fb610782565b6104045f610888565b565b5f60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60606004805461043d9061102f565b80601f01602080910402602001604051908101604052809291908181526020018280546104699061102f565b80156104b45780601f1061048b576101008083540402835291602001916104b4565b820191905f5260205f20905b81548152906001019060200180831161049757829003601f168201915b5050505050905090565b5f5f6104c86105e6565b90506104d5818585610692565b600191505092915050565b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054905092915050565b61056a610782565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036105da575f6040517f1e4fbdf70000000000000000000000000000000000000000000000000000000081526004016105d19190610fab565b60405180910390fd5b6105e381610888565b50565b5f33905090565b6105fa838383600161094b565b505050565b5f61060a84846104e0565b90507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff81101561068c578181101561067d578281836040517ffb8f41b20000000000000000000000000000000000000000000000000000000081526004016106749392919061105f565b60405180910390fd5b61068b84848484035f61094b565b5b50505050565b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610702575f6040517f96c6fd1e0000000000000000000000000000000000000000000000000000000081526004016106f99190610fab565b60405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610772575f6040517fec442f050000000000000000000000000000000000000000000000000000000081526004016107699190610fab565b60405180910390fd5b61077d838383610b1a565b505050565b61078a6105e6565b73ffffffffffffffffffffffffffffffffffffffff166107a8610406565b73ffffffffffffffffffffffffffffffffffffffff1614610807576107cb6105e6565b6040517f118cdaa70000000000000000000000000000000000000000000000000000000081526004016107fe9190610fab565b60405180910390fd5b565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610879575f6040517fec442f050000000000000000000000000000000000000000000000000000000081526004016108709190610fab565b60405180910390fd5b6108845f8383610b1a565b5050565b5f60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160055f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16036109bb575f6040517fe602df050000000000000000000000000000000000000000000000000000000081526004016109b29190610fab565b60405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610a2b575f6040517f94280d62000000000000000000000000000000000000000000000000000000008152600401610a229190610fab565b60405180910390fd5b8160015f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055508015610b14578273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92584604051610b0b9190610ed4565b60405180910390a35b50505050565b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610b6a578060025f828254610b5e91906110c1565b92505081905550610c38565b5f5f5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054905081811015610bf3578381836040517fe450d38c000000000000000000000000000000000000000000000000000000008152600401610bea9392919061105f565b60405180910390fd5b8181035f5f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550505b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610c7f578060025f8282540392505081905550610cc9565b805f5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825401925050819055505b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef83604051610d269190610ed4565b60405180910390a3505050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f610d7582610d33565b610d7f8185610d3d565b9350610d8f818560208601610d4d565b610d9881610d5b565b840191505092915050565b5f6020820190508181035f830152610dbb8184610d6b565b905092915050565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610df082610dc7565b9050919050565b610e0081610de6565b8114610e0a575f5ffd5b50565b5f81359050610e1b81610df7565b92915050565b5f819050919050565b610e3381610e21565b8114610e3d575f5ffd5b50565b5f81359050610e4e81610e2a565b92915050565b5f5f60408385031215610e6a57610e69610dc3565b5b5f610e7785828601610e0d565b9250506020610e8885828601610e40065b9150509250929050565b5f8115159050919050565b610ea681610e92565b82525050565b5f602082019050610ebf5f830184610e9d565b92915050565b610ece81610e21565b82525050565b5f602082019050610ee75f830184610ec5565b92915050565b5f5f5f60608486031215610f0457610f03610dc3565b5b5f610f1186828701610e0d565b9350506020610f2286828701610e0d565b9250506040610f3386828701610e40065b9150509250925092565b5f60ff82169050919050565b610f5281610f3d565b82525050565b5f602082019050610f6b5f830184610f49565b92915050565b5f60208284031215610f8657610f85610dc3565b5b5f610f9384828501610e0d565b91505092915050565b610fa581610de6565b82525050565b5f602082019050610fbe5f830184610f9c565b92915050565b5f5f60408385031215610fda57610fd9610dc3565b5b5f610fe785828601610e0d565b9250506020610ff885828601610e0d565b9150509250929050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061104657607f821691505b60208210810361105957611058611002565b5b50919050565b5f6060820190506110725f830186610f9c565b61107f6020830185610ec5565b61108c6040830184610ec5565b949350505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6110cb82610e21565b91506110d683610e21565b92508282019050808211156110ee576110ed611094565b5b9291505056fea26469706673582212203cc931b1cf1235f08e73337b3d80fc05bcf84229423384dd6af9d8ef9614f9ea64736f6c634300081c0033";

async function deployWorkingContract() {
  try {
    console.log('Deploying working contract...');
    
    // Deploy a simple contract
    const hash = await walletClient.deployContract({
      abi: [],
      bytecode: SIMPLE_CAMPAIGN_MANAGER_BYTECODE,
    });
    
    console.log('Deployment transaction hash:', hash);
    
    // Wait for confirmation
    const receipt = await publicClient.waitForTransactionReceipt({ hash });
    console.log('Contract deployed at:', receipt.contractAddress);
    
    return receipt.contractAddress;
    
  } catch (error) {
    console.error('Deployment failed:', error);
    return null;
  }
}

deployWorkingContract();
